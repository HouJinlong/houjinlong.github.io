(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{527:function(t,s,a){"use strict";function n(t,s,a,n,e,r,o,p){var l,c="function"==typeof t?t.options:t;if(s&&(c.render=s,c.staticRenderFns=a,c._compiled=!0),n&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),o?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=l):e&&(l=p?function(){e.call(this,this.$root.$options.shadowRoot)}:e),l)if(c.functional){c._injectStyles=l;var _=c.render;c.render=function(t,s){return l.call(s),_(t,s)}}else{var v=c.beforeCreate;c.beforeCreate=v?[].concat(v,l):[l]}return{exports:t,options:c}}a.d(s,"a",(function(){return n}))},561:function(t,s,a){"use strict";a.r(s);var n=a(527),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("前情提要：同事做的一个 "),a("code",[t._v("svelte")]),t._v(" 调研项目，增加babel时一直有问题，而且同事有别的项目排着比较忙，领导让我帮忙看看，好嘛走起，一顿操作，解决了，顺带了解了一些之前没注意的姿势，在这做个记录！")])]),t._v(" "),a("h2",{attrs:{id:"babel-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel-loader"}},[t._v("#")]),t._v(" babel-loader")]),t._v(" "),a("p",[t._v("注意俩点：")]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("const babelLoaderConfig = "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tloader"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 'babel-loader'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\toptions"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tpresets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("'@babel/preset-env'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\ttargets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("'> "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("%'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 'last "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" versions'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 'ie >= "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\tuseBuiltIns"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 'entry'\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\ttest"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" /\\.(m?js)$/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tuse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("babelLoaderConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\texclude"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" /node_modules\\/(?!svelte)/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("h3",{attrs:{id:"_1-exclude"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-exclude"}},[t._v("#")]),t._v(" 1. exclude")]),t._v(" "),a("p",[a("code",[t._v("svelte")]),t._v(" 包是未编译过的(打开看一下就知道)，需要对它也编译一下")]),t._v(" "),a("h3",{attrs:{id:"_2-test"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-test"}},[t._v("#")]),t._v(" 2. test")]),t._v(" "),a("p",[a("code",[t._v("svelte")]),t._v(" 包的package.json 都指定了"),a("code",[t._v('"module": "./index. mjs"')]),t._v("，例如(node_modules\\svelte\\internal\\package.json) 所以需要对 mjs文件也进行编译")]),t._v(" "),a("p",[t._v("备注: 这块之前没注意，看源码的时候发现 文件都有俩份"),a("code",[t._v(".js")]),t._v("和"),a("code",[t._v(".mjs")]),t._v(" 于是修改源码增加调试代码发现，都走了 "),a("code",[t._v(".mjs")]),t._v(" ，然后去了解了下 "),a("a",{attrs:{href:"https://segmentfault.com/a/1190000014286439",title:"原因(文章地址)",target:"_blank",rel:"noopener noreferrer"}},[t._v("原因(文章地址)"),a("OutboundLink")],1),t._v("，")]),t._v(" "),a("h2",{attrs:{id:"babel配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel配置"}},[t._v("#")]),t._v(" babel配置")]),t._v(" "),a("blockquote",[a("p",[t._v("上面问题已经解决了，这块是 同事临时提了一句，babel的配置我已经写在 "),a("code",[t._v(".babelrc")]),t._v(" 是否不用写 options 了？嗯，应该是，去掉， 报错..... 很奇怪啊，why")])]),t._v(" "),a("h3",{attrs:{id:""}},[a("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])]),t._v(" "),a("p",[t._v("修改 "),a("code",[t._v("node_modules\\babel-loader\\lib\\index.js")])]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" babel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadPartialConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("injectCaller")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("programmaticOptions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'config'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//增加的")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("重新构建，查看输出\n"),a("a",{attrs:{href:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijldxkrcj313409t0vd.jpg",title:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijldxkrcj313409t0vd.jpg",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijldxkrcj313409t0vd.jpg",alt:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijldxkrcj313409t0vd.jpg",title:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijldxkrcj313409t0vd.jpg"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("项目文件有，"),a("code",[t._v("node_modules")]),t._v("里的没有，我好像明白什么，打开"),a("a",{attrs:{href:"https://www.babeljs.cn/docs/configuration",title:"babel网站",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel网站果然有说到 希望编译 node_modules 目录下的模块要用 babel.config.js "),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("增加 "),a("code",[t._v("babel.config.js")]),t._v(" 重新构建，虽然"),a("code",[t._v(".babelrc")]),t._v(" 可能没有 但是 "),a("code",[t._v("babel.config.js")]),t._v("是全部都有的，且是同一份")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijuy9z5cj30z2094acm.jpg",title:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijuy9z5cj30z2094acm.jpg",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijuy9z5cj30z2094acm.jpg",alt:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijuy9z5cj30z2094acm.jpg",title:"http://ww1.sinaimg.cn/large/006I5hBxly1g9ijuy9z5cj30z2094acm.jpg"}}),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);